<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <record id="email_template_hr_upcoming_birthday_reminder" model="mail.template">
            <field name="name">Recordatorio de Cumpleaños a RRHH (7 Días Exactos)</field>
            <field name="subject">Recordatorio: Cumpleaños de Empleado(s) en 7 Días</field>
            <field name="email_from">{(user.company_id.email_formatted or user.email_formatted)}</field>
            <field name="email_to"></field> 
            <field name="model_id" ref="hr.model_hr_employee"/>
            <field name="auto_delete" eval="True"/>
            <field name="body_html" type="html">
                <div style="font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6; color: #333;">
                    <p>¡Hola equipo de Recursos Humanos!</p>
                    <p>Este es un recordatorio de los empleados que celebrarán su cumpleaños
                        exactamente en 7 días a partir del **<span t-out="ctx.get('today_date', '')"/>**:</p>

                    <p>Por favor, tomen nota y planifiquen las felicitaciones o acciones correspondientes:</p>
                    <ul t-if="ctx.get('employees')">
                        <t t-foreach="ctx.get('employees')" t-as="employee">
                            <t t-set="employee_birthday_date" t-value="employee.birthday.replace(year=datetime.date.today().year)"/>
                            <t t-if="employee_birthday_date &lt; datetime.date.today()">
                                <t t-set="employee_birthday_date" t-value="employee.birthday.replace(year=datetime.date.today().year + 1)"/>
                            </t>
                            <t t-set="days_until_birthday" t-value="(employee_birthday_date - datetime.date.today()).days"/>
                            
                            <li>
                                <strong><t t-out="employee.name"/></strong> 
                                (<t t-out="employee.job_id.name or 'N/A'"/>) - 
                                Cumpleaños el <span style="font-weight: bold; color: #007bff;"><t t-out="employee_birthday_date.strftime('%d/%m/%Y')"/></span> 
                                (en <t t-out="days_until_birthday"/> día(s))
                            </li>
                        </t>
                    </ul>
                    <p t-else="">No se encontraron empleados con cumpleaños en 7 días para este recordatorio.</p>
                   
                    <p>
                        Agradecemos su gestión para mantener un ambiente de trabajo positivo y celebrar a nuestros empleados.
                    </p>
                    <p style="margin-top: 20px; font-size: 12px; color: #777;">
                        Saludos cordiales,<br/>
                        El equipo de <t t-out="user.company_id.name or ''">YourCompany</t>.
                    </p>
                    <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;"/>
                    <p style="font-size: 10px; color: #aaa;">
                        Este es un mensaje generado automáticamente, por favor no responda a este correo.
                    </p>
                </div>
            </field>
        </record>
    </data>
</odoo>